<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Financeiro e Equipe</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script>
        // Paleta de cores customizada
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'brand-blue': '#005A8C',
                        'brand-blue-dark': '#004C75',
                        'brand-green': '#4CAF50',
                        'brand-green-dark': '#388E3C',
                        'brand-orange': '#FFA000',
                        'brand-orange-light': '#FFECB3',
                        'brand-background': '#F0F4F8',
                        'brand-surface': '#FFFFFF',
                        'brand-text-primary': '#1E293B',
                        'brand-text-secondary': '#475569',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: theme('colors.brand-background');
            color: theme('colors.brand-text-primary');
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            height: 450px;
            max-height: 60vh;
        }
        .card {
             background-color: theme('colors.brand-surface');
             border-radius: 0.75rem;
             padding: 1.5rem;
             box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
             transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 12px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08);
        }
        table thead th {
            background-color: #E2E8F0;
            color: theme('colors.brand-text-primary');
            font-weight: 600;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-extrabold text-brand-blue">Painel Financeiro e Equipe</h1>
            <p class="text-brand-text-secondary mt-2 text-lg">Análise Financeira e Estrutura de Custos da Equipe</p>
        </header>

        <main>
            <!-- Análise Financeira Section -->
            <section id="content-analysis" class="mb-12">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-brand-text-primary">Análise Financeira</h2>
                    <p class="text-brand-text-secondary mt-1">Custos operacionais, fluxo de caixa e projeções de saldo.</p>
                </div>
                <div class="card p-4 sm:p-6 mb-8">
                    <h3 class="text-xl font-semibold text-center mb-4">Despesas Mensais do Fórum</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left">
                            <thead><tr><th class="px-4 py-3">Descrição</th><th class="px-4 py-3 text-right">Custo Com Convênios</th><th class="px-4 py-3 text-right">Custo Sem Convênios</th></tr></thead>
                            <tbody id="expense-table-body"></tbody>
                            <tfoot class="font-semibold text-brand-text-primary text-base"><tr class="border-t-2 border-slate-300"><td class="px-4 py-3">Total Geral Mensal</td><td id="total-with-agreement" class="px-4 py-3 text-right"></td><td id="total-without-agreement" class="px-4 py-3 text-right"></td></tr></tfoot>
                        </table>
                    </div>
                    <div class="mt-6 p-4 bg-brand-green/10 border-l-4 border-brand-green rounded-r-lg">
                        <p class="text-lg font-semibold text-brand-green-dark">Redução Mensal de Custo: <span id="monthly-savings" class="font-bold"></span></p>
                        <p class="text-sm text-brand-green-dark/80">O convênio resulta em uma economia significativa, reduzindo o custo operacional do Fórum.</p>
                    </div>
                </div>
                <div class="card p-6">
                    <h3 class="text-xl font-semibold text-center mb-4">Projeção de Fluxo de Caixa com Saldo Acumulado</h3>
                    <div class="text-center mb-4"><span class="text-brand-text-secondary">Saldo atual: R$ 76.598,23</span></div>
                    <div class="chart-container"><canvas id="cashflowChart"></canvas></div>
                    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-4 text-center">
                        <div class="p-4 bg-red-50 rounded-lg">
                            <h4 class="font-semibold text-red-800">Aporte ao Convênio</h4>
                            <p class="text-lg font-bold text-red-600">- R$ 50.000,00</p>
                            <p class="text-sm text-red-700">A ser pago em Novembro</p>
                        </div>
                        <div class="p-4 bg-green-50 rounded-lg">
                            <h4 class="font-semibold text-green-800">Saldo Final Previsto (Dez)</h4>
                            <p id="final-balance" class="text-lg font-bold text-green-600"></p>
                            <p class="text-sm text-green-700">Acumulado ao final do ano</p>
                        </div>
                        <div class="p-4 bg-red-50 rounded-lg">
                            <h4 class="font-semibold text-red-800">Aporte ao Convênio</h4>
                            <p class="text-lg font-bold text-red-600">- R$ 120.000,00</p>
                            <p class="text-sm text-red-700">A ser pago em Março/2026</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Equipe Section -->
            <section id="content-equipe">
                <div class="text-center mb-10">
                    <h2 class="text-3xl font-bold text-brand-text-primary">Estrutura de Custos da Equipe</h2>
                    <p class="text-brand-text-secondary mt-1">Detalhamento dos custos mensais e anuais por profissional e convênio.</p>
                </div>
                <div class="card p-8">
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead><tr class="bg-slate-200"><th class="p-3">NOME</th><th class="p-3">MÊS</th><th class="p-3">TOTAL ANO</th><th class="p-3">TIPO</th></tr></thead>
                            <tbody id="team-table-body"></tbody>
                            <tfoot><tr class="bg-slate-100 font-bold text-base"><td class="p-3">Total</td><td class="p-3">R$ 48.942,40</td><td class="p-3">R$ 587.308,80</td><td></td></tr></tfoot>
                        </table>
                    </div>
                    <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="p-4 bg-brand-orange-light border-l-4 border-brand-orange rounded-r-lg">
                            <h4 class="font-semibold text-brand-text-primary">Custo Mensal (Fórum)</h4>
                            <p class="text-2xl font-bold text-brand-blue">R$ 9.660,00</p>
                            <p class="text-sm text-brand-text-secondary">Anual: R$ 115.920,00</p>
                        </div>
                        <div class="p-4 bg-brand-orange-light border-l-4 border-brand-orange rounded-r-lg">
                            <h4 class="font-semibold text-brand-text-primary">Custo Mensal (Sebrae)</h4>
                            <p class="text-2xl font-bold text-brand-blue">R$ 15.480,00</p>
                            <p class="text-sm text-brand-text-secondary">Anual: R$ 185.760,00</p>
                        </div>
                        <div class="p-4 bg-brand-orange-light border-l-4 border-brand-orange rounded-r-lg">
                            <h4 class="font-semibold text-brand-text-primary">Custo Mensal (Seplan)</h4>
                            <p class="text-2xl font-bold text-brand-blue">R$ 21.102,40</p>
                            <p class="text-sm text-brand-text-secondary">Anual: R$ 253.228,80</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Função para formatar valores como moeda brasileira
        const formatCurrency = (value) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);

        // Objeto central com todos os dados da aplicação
        const appData = {
            expenses: [
                { label: 'Equipe Fórum', with: 9660.00, without: 48942.40 },
                { label: 'Consultor DEL - Contrato e Diária', with: 29800, without: 29800 },
                { label: 'Passagem Estácio DEL Acre', with: 3000, without: 3000 },
                { label: 'Passagem Estácio DEL Amapá', with: 2500, without: 2500 },
                { label: 'Contador', with: 1300, without: 1300 },
                { label: 'ISS', with: 800, without: 800 },
                { label: 'Taxi', with: 400, without: 400 },
                { label: 'Limpeza, Energia, Telefone e Internet', with: 1864, without: 1864 },
                { label: 'Locação Sala', with: 2650, without: 2650 },
                { label: 'Fundo Fixo', with: 759, without: 759 },
                { label: 'Taxa Bancária', with: 150, without: 150 },
                { label: 'Material de Expediente e Outros', with: 600, without: 600 },
            ],
            cashflow: {
                initialBalance: 122384.37,
                months: [
                    { 
                        month: 'Setembro', 
                        revenues: { 
                            total: 89780.00, 
                            details: [ 
                                { source: 'DEL Turismo - Epitaciolândia', value: 8400 }, 
                                { source: 'DEL Turismo - Rio Branco', value: 17000 }, 
                                { source: 'DEL Turismo - Amapá', value: 37500 },
                                { source: 'DEL Epitaciolândia (Julho e Agosto)', value: 16800 }
                            ]
                        }, 
                        expenses: { 
                            total: 113817.18, 
                            details: [ 
                                { source: 'Estudos e Pesquisas', value: 49620.00 },
                                { source: 'Fórum', value: 64197.18 }
                            ]
                        } 
                    },
                    { month: 'Outubro', revenues: { total: 72980, details: [ { source: 'DEL Turismo - Epitaciolândia', value: 8400 }, { source: 'DEL Turismo - Xapuri', value: 10080 }, { source: 'DEL Turismo - Rio Branco', value: 17000 }, { source: 'DEL Turismo - Amapá', value: 37500 } ]}, expenses: { total: 53483.00, details: [ { source: 'Fórum', value: 53483.00 } ]} },
                    { month: 'Novembro', revenues: { total: 135980, details: [ { source: 'DEL Turismo - Epitaciolândia', value: 8400 }, { source: 'DEL Turismo - Xapuri', value: 10080 }, { source: 'DEL Turismo - Rio Branco', value: 17000 }, { source: 'DEL Turismo - Amapá', value: 37500 }, { source: 'DEVOLUÇÃO IEL', value: 63000 } ]}, expenses: { total: 10483.00, details: [ { source: 'Fórum', value: 53483.00 }, { source: 'Aporte Convênio', value: 50000 } ]} },
                    { month: 'Dezembro', revenues: { total: 55980, details: [ { source: 'DEL Turismo - Epitaciolândia', value: 8400 }, { source: 'DEL Turismo - Xapuri', value: 10080 }, { source: 'DEL Turismo - Amapá', value: 37500 } ]}, expenses: { total: 53483.00, details: [ { source: 'Fórum', value: 53483.00 } ]} }
                ]
            },
            team: [
                { name: 'ANNA FÁBIA FITTIPALDY DE OLIVEIRA', month: 1350.00, year: 16200.00, type: 'ESTAGIÁRIA (SEBRAE)' },
                { name: 'LAIANNY SENA DA SILVA', month: 1350.00, year: 16200.00, type: 'ESTAGIÁRIA (SEBRAE)' },
                { name: 'ANDRÉ FERREIRA SANTANA', month: 2160.00, year: 25380.00, type: 'ME (SEBRAE)' },
                { name: 'ANA PAULA PEREIRA DA SILVA', month: 3600.00, year: 43200.00, type: 'MEI (SEBRAE)' },
                { name: 'EROS CÁSSIUS RIBEIRO DE MELO', month: 1680.00, year: 20160.00, type: 'MEI (SEBRAE)' },
                { name: 'ALINE DO NASCIMENTO LIMA', month: 3000.00, year: 36000.00, type: 'MEI (SEBRAE)' },
                { name: 'MARIA DA CONCEIÇÃO', month: 5040.00, year: 60480.00, type: 'MEI (SEBRAE)' },
                { name: 'STEFANI GABRIELE DE ALMEIDA CAR', month: 5000.00, year: 60000.00, type: 'MEI (FÓRUM)' },
                { name: 'JULIANA MONTEIRO DA CRUZ VILA N (COM IMPOSTOS)', month: 2660.00, year: 31920.00, type: 'MEI (SEBRAE)' },
                { name: 'JULIANA MONTEIRO DA CRUZ VILA N', month: 4939.93, year: 59279.16, type: 'MEI (SEPLAN)' },
                { name: 'VELOSO LTDA', month: 2000.00, year: 24000.00, type: 'ME (FÓRUM)' },
                { name: 'VELOSO LTDA', month: 16162.47, year: 193949.64, type: 'ME (SEPLAN)' },
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            // Renderiza a tabela de despesas mensais
            const expenseTableBody = document.getElementById('expense-table-body');
            const totalWith = appData.expenses.reduce((sum, item) => sum + item.with, 0);
            const totalWithout = appData.expenses.reduce((sum, item) => sum + item.without, 0);
            appData.expenses.forEach(item => {
                const row = expenseTableBody.insertRow();
                row.className = 'border-b border-slate-200';
                row.innerHTML = `<td class="px-4 py-2">${item.label}</td><td class="px-4 py-2 text-right">${formatCurrency(item.with)}</td><td class="px-4 py-2 text-right text-brand-text-secondary">${formatCurrency(item.without)}</td>`;
            });
            document.getElementById('total-with-agreement').textContent = formatCurrency(totalWith);
            document.getElementById('total-without-agreement').textContent = formatCurrency(totalWithout);
            document.getElementById('monthly-savings').textContent = formatCurrency(totalWithout - totalWith);

            // Renderiza a tabela da equipe
            const teamTableBody = document.getElementById('team-table-body');
            appData.team.forEach(member => {
                const row = teamTableBody.insertRow();
                row.className = 'hover:bg-slate-50';
                row.innerHTML = `<td class="p-3 border border-slate-200">${member.name}</td><td class="p-3 border border-slate-200">${formatCurrency(member.month)}</td><td class="p-3 border border-slate-200">${formatCurrency(member.year)}</td><td class="p-3 border border-slate-200">${member.type}</td>`;
            });
            
            // --- GRÁFICO DE FLUXO DE CAIXA ---
            const cashflowCtx = document.getElementById('cashflowChart').getContext('2d');
            
            // O valor do saldo atual no HTML é fixo. O script usa o initialBalance abaixo para os cálculos.
            
            let cumulativeBalance = appData.cashflow.initialBalance;
            const cumulativeBalances = appData.cashflow.months.map(m => {
                let monthlyResult = m.revenues.total - m.expenses.total;
                cumulativeBalance += monthlyResult;
                return cumulativeBalance;
            });
            
            document.getElementById('final-balance').textContent = formatCurrency(cumulativeBalances[cumulativeBalances.length - 1]);

            new Chart(cashflowCtx, {
                type: 'bar',
                data: {
                    labels: appData.cashflow.months.map(m => m.month),
                    datasets: [
                        { label: 'Receitas', data: appData.cashflow.months.map(m => m.revenues.total), backgroundColor: '#4CAF50', order: 2 },
                        { label: 'Despesas', data: appData.cashflow.months.map(m => m.expenses.total), backgroundColor: '#f87171', order: 2 },
                        { label: 'Saldo Acumulado', data: cumulativeBalances, type: 'line', borderColor: '#005A8C', backgroundColor: 'transparent', tension: 0.2, borderWidth: 4, pointRadius: 6, pointBackgroundColor: '#005A8C', pointHoverRadius: 8, order: 1 }
                    ]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    scales: { y: { ticks: { callback: value => formatCurrency(value) } } },
                    plugins: {
                        tooltip: {
                            enabled: true,
                            callbacks: {
                                footer: function(tooltipItems) {
                                    const index = tooltipItems[0].dataIndex;
                                    const monthData = appData.cashflow.months[index];
                                    
                                    let details = ['\n--- Detalhamento ---'];
                                    details.push('RECEITAS:');
                                    monthData.revenues.details.forEach(detail => {
                                        details.push(`  + ${detail.source}: ${formatCurrency(detail.value)}`);
                                    });

                                    details.push('\nDESPESAS:');
                                     monthData.expenses.details.forEach(detail => {
                                        details.push(`  - ${detail.source}: ${formatCurrency(detail.value)}`);
                                    });

                                    const prevBalance = index > 0 ? cumulativeBalances[index - 1] : appData.cashflow.initialBalance;
                                    
                                    let monthlyBalance = monthData.revenues.total - monthData.expenses.total;

                                    details.push('\n--- Saldo do Mês ---');
                                    details.push(`Saldo Anterior: ${formatCurrency(prevBalance)}`);
                                    details.push(`Resultado do Mês: ${formatCurrency(monthlyBalance)}`);
                                    
                                    return details;
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>

